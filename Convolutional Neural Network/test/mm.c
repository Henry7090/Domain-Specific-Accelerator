#include<stdio.h>
#include <stdlib.h>
#include <time.h>



int main()
{
    
    

    // Initialize 12x12 image matrix
    float img[144] = {
        0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 ,0.000000 ,0.000000,
        0.000000, 0.178941, 0.331647, 0.306785, 0.164061, 0.059413, 0.001426, 0.000000, 0.000000, 0.000000 ,0.000000 ,0.000000,
        0.000000, 0.518085, 3.834416, 4.894515, 4.708272, 3.750915, 3.172047, 2.397671, 1.008002, 0.182765 ,0.000000 ,0.000000,
        0.000000, 0.000000, 1.789098, 2.568928, 3.418630, 3.767936, 5.433307, 6.936704, 7.205945, 4.914394 ,0.524623 ,0.000000,
        0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.490284, 5.040545, 10.482951, 2.216021, 0.000000,
        0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 1.103581, 10.539873, 2.810704, 0.000000,
        0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 3.220083, 9.532099 ,1.469740 ,0.000000,
        0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.271317, 7.844151, 5.618972 ,0.139351 ,0.000000,
        0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 4.584897, 8.024216, 1.198596 ,0.000000 ,0.000000,
        0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 2.945014, 8.244088, 2.769125, 0.000000 ,0.000000 ,0.000000,
        0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.928872, 8.619120, 4.887682, 0.153855, 0.000000 ,0.000000 ,0.000000,
        0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 4.941913, 7.512284, 0.968217, 0.000000, 0.000000 ,0.000000 ,0.000000
    };

    // Initialize 5x5 weight matrix
    float weight[25]= { 
    -0.049787, -0.162016, -0.104291,  0.067856, -0.136645,
    -0.015705,  0.091655,  0.184592,  0.131128, -0.114803,
    -0.125117,  0.003831,  0.299478,  0.332725,  0.086146,
    -0.015919, -0.238835, -0.127737,  0.138527,  0.253835,
     0.016796,  0.024774, -0.201379, -0.218248,  0.055943
    };
    

    // Output 8x8 matrix
    float answer[64];

    // Perform convolution
    for (int i = 0; i < 8; i++) { // Output rows
        for (int j = 0; j < 8; j++) { // Output columns
            float sum = 0;

            // Convolution with 5x5 weights
            for (int wi = 0; wi < 5; wi++) { // Weight rows
                for (int wj = 0; wj < 5; wj++) { // Weight columns
                    int img_row = i + wi; // Map weight row to image row
                    int img_col = j + wj; // Map weight column to image column
                    sum += img[img_row * 12 + img_col] * weight[wi * 5 + wj];
                }
            }

            answer[i * 8 + j] = sum; // Store result in output matrix
        }
    }

    // Print result
    for (int i = 0; i < 8; i++) {
        for (int j = 0; j < 8; j++) {
            printf("%f ", answer[i*8+j]);
        }
        printf("\n");
    }

    // return 0;
    
    
    
    
    
    
    
    // // for(int i = 0;i<144;i++){
    // //    *(float volatile *)0xC4400004 = img[i];
    // // }
    // // for(int i = 0;i<25;i++){
    // //     *(float volatile *)0xC4400000 = weight[i];
    // // }
    // int index = 0;
    // // int ans_index = 0;
    // // float answer[64];

    // // *(int volatile *)0xC4400008 = 1;
    // // answer[0] = *(float volatile *)0xC440000c;
    // // printf("%f\n", answer[0]);
    // for(int i = 0;i < 8;i++){
    //     for(int j = 0;j<8;j++){
            
    //         if(index%12 == 7){
    //             index += 5;
    //         }
    //         else{
    //             index++;
    //         }
    //         printf("index = %d\n", index);
    //     }
    // }
    
}